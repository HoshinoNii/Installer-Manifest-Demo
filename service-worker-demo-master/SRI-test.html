<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subresource Integrity</title>

    <script src="js/sri-error-handling-mutation-observer.js"></script> 
    <script src="js/sri-error-handling.js"></script>   
    

    <link href="http://127.0.0.1:5500/css/red-bold.css" 
        rel="stylesheet" 
        integrity="sha384-kg/f+/0JBg1RLlfsa/vT5ESIobmqHUqD9RWTMePLAMhL9Ps0N56acQvkkzn6a6aD" 
        crossorigin="anonymous">

    <link href="css/main.css" 
        rel="stylesheet" 
        crossorigin="anonymous">
</head>
<body>
    
    <h1>SRI Integrity Test</h1>
    <p>Before You Start, Make sure the the external Server is running</p>

    <p>This will run a script test, the sri-test.js has a valid sri hash, if not this button will do nothing</p>
    <button onClick="clickTest();">Click ME!</button>

    <p>This button will not do anything, as the script it has is a invalid sha384 hash</p>
    <button onClick="tryInvalidSRI();">Click ME!</button>
    <br/>
    <p class="red-bold">This button will use a script in port 8000, Also this text should be red and bold if the css SRI passes</p>
    <button onClick="clickSRI();">Click ME!</button>
    <div id="basicBg">TEST</div>


        <script>
            function tryInvalidSRI() {

                try {
                    clickTest2();
                } catch (err) {
                    document.getElementById('basicBg').style.color = 'red'
                    document.getElementById('basicBg').innerHTML = 'Failed to find a valid digest in the \'integrity\' attribute for resource \'http://127.0.0.1:5500/js/invalid_sri-test.js?n=1\' with computed SHA-256 integrity \'sAj0j5jN9sJuy43RwufHWuo40C3XFiLBQni7FOlkLhw=\'. The resource has been blocked.'
                }
                
            }

            function tryOnError(event) {
                console.log(event)
            }
        </script>
        <script src="js/sri-test.js?n=1" 
            integrity="sha384-CSUtFptQtN3D5Uu5NRbWTQgSYKVZyCMOWrUBMN6R6oO7Mt9q7zCjRxvfjNgvP98R" 
            crossorigin="anonymous"></script>

        <script src="js/invalid_sri-test.js?n=1" 
            integrity="sha384-P938sgFHMGIRtqcjxItVRLSFUJ9JuIsiszy3IL15UiEmMgHr2G9Q9KIwRv5xIxXy"
            onerror="javascript:onErrorAttribute(this, event);"    
            crossorigin="anonymous"></script>
            
        <script src="http://127.0.0.1:5500/js/sri-hash.js?n=1" 
                integrity="sha384-AiaJdR+yCiYC2EpaHwWtHro+jszoGUsKh3qvRUMz4+NZuJw5zeGhcBbrXA35V0Lo" 
                crossorigin="anonymous">   
        </script>

        
</body>
</html>